<div class="row">
	<div class="col-md-12">
		<div class="panel panel-default">
			<div class="panel-heading" style="height:55px;">
					<h3 class="panel-title" style="float:left; padding:8px 0;">
						{{ pull.value.title }}
					</h3>
					<span class="pull-right">
						<div ng-show="vote.value" style="padding:8px 0;">
							{{ status.value }} (you voted {{ vote.value.vote }})
						</div>
						<div ng-show="!vote.value">
							<div class="btn-group">
								<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
									{{ status.value }}
									<span class="caret"></span>
								</button>
								<ul class="dropdown-menu">
									<li ng-repeat="vote in ninja.value.config.votes"><a href ng-click="castVote(vote.value)">{{ vote.label }}</a></li>
								</ul>
							</div>
						</div>
					</span>
			</div>
			<div class="panel-body">
				<span>
					<img ng-src="{{ pull.value.user.avatar_url }}" width="18px" />
					{{ pull.value.user.login }} <small moment="pull.value.created_at"></small>
					<img ng-src="/badge/{{ repo.value.owner.login }}/{{ repo.value.name }}/{{ pull.value.head.sha }}">
				</span>
				<span class="pull-right">
				<button ng-show="status.value==='approved'" class="btn btn-primary">Merge</button>
				</span>
			</div>
		</div>
	</div>
</div>

<div class="row">
	<div class="col-md-12">

		<tabset>
		<tab heading="Stats">
				<h3>Commit</h3>
				<ul>
					<li>
						{{ comm.value.sha }}
					</li>
				</ul>
				<h3>Parents</h3>				
				<ul>
					<li ng-repeat="comm in comm.value.parents">
						{{ comm.sha }}
					</li>
				</ul>
				<h3>Files</h3>				
				<ul>
					<li ng-repeat="file in comm.value.files">
						{{ file.filename }} ({{ file.status }}, additions: {{ file.additions}}, deletions: {{ file.deletions }})
					</li>
				</ul>
				<h3>Status</h3>				
				<ul>
					<li ng-repeat="stat in stat.value">
						{{ stat.context }} {{ stat.description }} {{ stat.state }}
					</li>
				</ul>
				<h3>Votes</h3>				
				<ul>
					<li ng-repeat="vote in votes.value">
						{{ vote.vote }} {{ vote.user }}
					</li>
				</ul>
				<h3>Comments</h3>				
				<ul>
					<li ng-repeat="comment in comments.value">
						{{ comment.user.login }}, {{ comment.body }}
					</li>
				</ul>
				<h3>Issues</h3>				
				<ul>
					<li ng-repeat="issue in issue.value">
						{{ issue.user.login }}, {{ issue.title }}
					</li>
				</ul>
			</tab>

			<tab heading="Commits">
				<table class="table table-striped table-hover">
					<thead>
						<tr>
							<th>sha</th>
							<th>message</th>
							<th>author</th>
							<th>date</th>
							<th>status</th>
						</tr>
					</thead>
					<tbody>
						<tr ng-repeat="commit in commits.value | orderBy:'commit.committer.date':true">
							<td>
								<span ng-show="$index===0">
									<a ui-sref="comm({ user:repo.value.owner.login, repo:repo.value.name, sha:commit.sha })">
										{{ commit.sha | limitTo:10 }}
									</a>
								</span>
								<span ng-show="$index!==0">
									{{ commit.sha | limitTo:10 }}
								</span>
							</td>
							<td>{{ commit.commit.message }}</td>
							<td>{{ commit.author.login }}</td>
							<td moment="commit.commit.committer.date"></td>
							<td>{{ commit.status.value }}</td>
						</tr>
					</tbody>
				</table>
			</tab>

			<tab heading="Diff">
				<div ng-repeat="file in files.value" class="panel panel-default" style="margin-top:20px;">
					<div class="panel-heading">
						<strong>
							{{ file.filename }}
						</strong>
						<span class="pull-right">
							<small>status: {{ file.status }} | {{ file.additions }} additions | {{ file.deletions }} deletions | {{ file.changes }} changes</small>
						</span>
					</div>

					<div class="panel-body" ng-show="file.status=='renamed'">
						This file was renamed.
					</div>

					<div class="panel-body" ng-show="file.status=='modified' || file.status=='added' || file.status=='removed'" style="padding:0;">
						<diff content="file.patch"></diff>
					</div>
				</div>
			</tab>

			<tab heading="Files">
				<browser data="tree"></browser>
			</tab>

			<tab heading="Issues">
				<ul class="media-list" ng-repeat="issue in issue.value">
  					<li class="media">
						<a class="pull-left" href="#">
							<img class="media-object" ng-src="{{ issue.user.avatar_url }}" alt="{{ issue.user.login }}" style="width:48px;height:48px">
    					</a>
    					<div class="media-body">
      						<h4 class="media-heading">{{ issue.title }}</h4>
      						<p></p>
      						<div class="media" ng-repeat="comment in issue.fetchedComments.value">
            					<a class="pull-left" href="#">
              						<img class="media-object" ng-src="{{ comment.user.avatar_url }}" alt="{{ comment.user.login }}"  style="width: 48px; height: 48px;">
            					</a>
            					<div class="media-body">
              						{{ comment.body }}
              					</div>
            				</div>
    					</div>
  					</li>
				</ul>
			</tab>

			<tab heading="Comments">
				<div style="margin-top:20px;">
					<div ng-repeat="comment in commitComments.value" class="panel panel-default">
						<div class="panel-heading">
							<img ng-src="{{ comment.user.avatar_url }}" width="14px" />
							{{ comment.user.login }} <small moment="comment.created_at"></small>
						</div>
						<div class="panel-body">
							{{ comment.body }}
						</div>
					</div>

					<div class="panel panel-default">
						<div class="panel-heading">
							Comment
							<i class="fa fa-lg fa-comments pull-right"></i>
						</div>
						<div class="panel-body">
							<textarea class="form-control" rows="3" ng-model="comment_body"></textarea>
						</div>
						<div class="panel-footer" style="height:50px;">
							<input type="checkbox" ng-model="comment_issue"> Also create an issue
							<span class="pull-right">
								<button ng-click="$parent.comment=null" type="button" class="btn btn-default btn-sm">Cancel</button>
								<button ng-click="comment(comment_body, comment_issue)" type="button" class="btn btn-primary btn-sm">Comment</button>
							</span>
						</div>
					</div>
				</div>
			</tab>

			<tab heading="Ninja">
				<file path="'.ninja'" content="ninja.value.ninja"></file>
			</tab>
		</tabset>

	</div>
</div>